<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ATS Resume Checker â€“ Upload Resume File</title>
<meta name="description" content="Upload your resume file (PDF, DOCX, TXT) and check ATS score against any job description.">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- PDF.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>

<!-- Mammoth.js for DOCX -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.21/mammoth.browser.min.js"></script>

<style>
body { font-family: Arial, sans-serif; background:#f6f8fa; margin:0; }
header { background:#0a66c2; color:#fff; padding:20px; text-align:center; }
main { max-width:1000px; margin:auto; background:#fff; padding:20px; }
textarea, input[type="file"] { width:100%; margin-bottom:15px; padding:10px; }
button { background:#0a66c2; color:#fff; border:none; padding:12px 20px; cursor:pointer; }
.result { background:#f0f7ff; padding:15px; margin-top:20px; }
.score { font-size:28px; font-weight:bold; }
.keywords span { background:#e0ecff; padding:5px 8px; margin:4px; display:inline-block; }
.missing span { background:#ffe0e0; }
.ad-box { background:#eee; padding:20px; text-align:center; margin:20px 0; }
</style>
</head>

<body>

<header>
<h1>ATS Resume Checker</h1>
<p>Upload your resume file & beat ATS systems</p>
</header>

<main>

<div class="ad-box">AdSense Ad Space</div>

<h2>Upload Resume File</h2>
<input type="file" id="resumeFile" accept=".pdf,.docx,.txt">

<h2>Paste Job Description</h2>
<textarea id="jobText" placeholder="Paste job description here..."></textarea>

<button onclick="processResume()">Check ATS Score</button>

<div id="output" class="result" style="display:none;"></div>

<div class="ad-box">In-content Ad Space</div>

</main>

<script>
async function processResume() {
  const fileInput = document.getElementById("resumeFile");
  const jobText = document.getElementById("jobText").value.toLowerCase();
  const output = document.getElementById("output");

  if (!fileInput.files.length || !jobText) {
    alert("Please upload resume file and paste job description.");
    return;
  }

  const file = fileInput.files[0];
  let resumeText = "";

  if (file.name.endsWith(".txt")) {
    resumeText = await file.text();
  }

  else if (file.name.endsWith(".pdf")) {
    const pdfData = new Uint8Array(await file.arrayBuffer());
    const pdf = await pdfjsLib.getDocument(pdfData).promise;
    for (let i = 1; i <= pdf.numPages; i++) {
      const page = await pdf.getPage(i);
      const content = await page.getTextContent();
      resumeText += content.items.map(item => item.str).join(" ");
    }
  }

  else if (file.name.endsWith(".docx")) {
    const arrayBuffer = await file.arrayBuffer();
    const result = await mammoth.extractRawText({ arrayBuffer });
    resumeText = result.value;
  }

  else {
    alert("Unsupported file type.");
    return;
  }

  analyzeATS(resumeText.toLowerCase(), jobText);
}

function analyzeATS(resume, job) {
  const output = document.getElementById("output");

  const jobWords = [...new Set(job.match(/\b[a-z]{3,}\b/g))];
  let matched = [];
  let missing = [];

  jobWords.forEach(word => {
    resume.includes(word) ? matched.push(word) : missing.push(word);
  });

  const score = Math.round((matched.length / jobWords.length) * 100);

  output.style.display = "block";
  output.innerHTML = `
    <div class="score">ATS Score: ${score}/100</div>

    <h3>Matched Keywords</h3>
    <div class="keywords">
      ${matched.map(w => `<span>${w}</span>`).join("")}
    </div>

    <h3>Missing Keywords</h3>
    <div class="keywords missing">
      ${missing.map(w => `<span>${w}</span>`).join("")}
    </div>

    <h3>Improvement Tips</h3>
    <ul>
      <li>Add missing keywords naturally</li>
      <li>Use simple formatting</li>
      <li>Avoid images & tables</li>
    </ul>
  `;
}
</script>

</body>
</html>
